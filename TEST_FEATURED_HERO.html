<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Featured Hero API</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 { color: #236b7c; }
        h2 { color: #333; margin-top: 30px; }
        button {
            background: #236b7c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #1d5766; }
        pre {
            background: #f8f8f8;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            border: 1px solid #ddd;
        }
        .success { color: #059669; }
        .error { color: #dc2626; }
        .warning { color: #d97706; }
        .info { color: #2563eb; }
        .result {
            margin: 15px 0;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #236b7c;
            background: #f0f9ff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Featured Hero API Tester</h1>
        <p>Test your featured hero API endpoints to see what's being returned.</p>

        <h2>1. Test Posts API</h2>
        <button onclick="testPosts()">Test Posts (All)</button>
        <button onclick="testFeaturedPosts()">Test Featured Posts</button>
        <div id="postsResult"></div>

        <h2>2. Test Guides API</h2>
        <button onclick="testGuides()">Test Guides (All)</button>
        <button onclick="testFeaturedGuides()">Test Featured Guides</button>
        <div id="guidesResult"></div>

        <h2>3. Test Featured Hero (Combined)</h2>
        <button onclick="testFeaturedHero()">Test Featured Hero Logic</button>
        <div id="heroResult"></div>

        <h2>4. Instructions</h2>
        <div class="result">
            <p><strong>How to use:</strong></p>
            <ol>
                <li>Make sure your backend is running on <code>http://localhost:8080</code></li>
                <li>Click the buttons above to test each endpoint</li>
                <li>Check the results below each section</li>
                <li>Look for any items with <code>featured_hero: true</code></li>
            </ol>
            <p><strong>Expected Results:</strong></p>
            <ul>
                <li>‚úÖ Status 200 = API working</li>
                <li>‚úÖ Array with items = Data exists</li>
                <li>‚úÖ <code>featured_hero: true</code> = Item is set as hero</li>
                <li>‚ö†Ô∏è Empty array = No data or no featured items</li>
                <li>‚ùå Error = API issue or backend not running</li>
            </ul>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8080';

        function displayResult(elementId, title, data, status) {
            const el = document.getElementById(elementId);
            const statusClass = status === 'success' ? 'success' : status === 'error' ? 'error' : 'warning';
            el.innerHTML = `
                <div class="result">
                    <h3 class="${statusClass}">${title}</h3>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                </div>
            `;
        }

        async function testPosts() {
            try {
                const response = await fetch(`${API_BASE}/posts?limit=10`);
                const data = await response.json();
                displayResult('postsResult', 
                    `‚úÖ Posts API (Status: ${response.status})`, 
                    {
                        count: data.length,
                        posts: data.map(p => ({
                            slug: p.slug,
                            title: p.title,
                            featured_hero: p.featured_hero || false,
                            published_at: p.published_at
                        }))
                    },
                    'success'
                );
            } catch (error) {
                displayResult('postsResult', '‚ùå Error fetching posts', { error: error.message }, 'error');
            }
        }

        async function testFeaturedPosts() {
            try {
                const response = await fetch(`${API_BASE}/posts?featured_hero=true&limit=1`);
                const data = await response.json();
                displayResult('postsResult', 
                    `${data.length > 0 ? '‚úÖ' : '‚ö†Ô∏è'} Featured Posts (Status: ${response.status})`, 
                    {
                        count: data.length,
                        featured: data
                    },
                    data.length > 0 ? 'success' : 'warning'
                );
            } catch (error) {
                displayResult('postsResult', '‚ùå Error fetching featured posts', { error: error.message }, 'error');
            }
        }

        async function testGuides() {
            try {
                const response = await fetch(`${API_BASE}/guides?limit=10`);
                const data = await response.json();
                displayResult('guidesResult', 
                    `‚úÖ Guides API (Status: ${response.status})`, 
                    {
                        count: data.length,
                        guides: data.map(g => ({
                            slug: g.slug,
                            title: g.title,
                            featured_hero: g.featured_hero || false,
                            published_at: g.published_at
                        }))
                    },
                    'success'
                );
            } catch (error) {
                displayResult('guidesResult', '‚ùå Error fetching guides', { error: error.message }, 'error');
            }
        }

        async function testFeaturedGuides() {
            try {
                const response = await fetch(`${API_BASE}/guides?featured_hero=true&limit=1`);
                const data = await response.json();
                displayResult('guidesResult', 
                    `${data.length > 0 ? '‚úÖ' : '‚ö†Ô∏è'} Featured Guides (Status: ${response.status})`, 
                    {
                        count: data.length,
                        featured: data
                    },
                    data.length > 0 ? 'success' : 'warning'
                );
            } catch (error) {
                displayResult('guidesResult', '‚ùå Error fetching featured guides', { error: error.message }, 'error');
            }
        }

        async function testFeaturedHero() {
            try {
                // Test posts first
                const postsResponse = await fetch(`${API_BASE}/posts?featured_hero=true&limit=1`);
                const posts = await postsResponse.json();
                
                // Then test guides
                const guidesResponse = await fetch(`${API_BASE}/guides?featured_hero=true&limit=1`);
                const guides = await guidesResponse.json();

                const result = {
                    posts: {
                        status: postsResponse.status,
                        count: posts.length,
                        data: posts
                    },
                    guides: {
                        status: guidesResponse.status,
                        count: guides.length,
                        data: guides
                    },
                    winner: posts.length > 0 ? 'POST' : guides.length > 0 ? 'GUIDE' : 'NONE',
                    featured_content: posts.length > 0 ? posts[0] : guides.length > 0 ? guides[0] : null
                };

                displayResult('heroResult', 
                    `${result.winner !== 'NONE' ? '‚úÖ' : '‚ö†Ô∏è'} Featured Hero Logic`, 
                    result,
                    result.winner !== 'NONE' ? 'success' : 'warning'
                );
            } catch (error) {
                displayResult('heroResult', '‚ùå Error testing featured hero', { error: error.message }, 'error');
            }
        }

        // Auto-run tests on load
        window.addEventListener('load', () => {
            console.log('üîç Featured Hero API Tester loaded');
            console.log('Click buttons to test endpoints');
        });
    </script>
</body>
</html>
